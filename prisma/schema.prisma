generator client {
  provider   = "prisma-client-js"
  engineType = "client"
}

datasource db {
  provider = "postgresql"
}

enum AccountStatus {
  ACTIVE
  DELETED
  ARCHIVED
}

enum TransactionType {
  INCOME
  OUTCOME
  TRANSFER
}

enum CategoryType {
  INCOME
  OUTCOME
  TRANSFER
}

model User {
  id        Int    @id() @default(autoincrement())
  email     String @unique()
  full_name String
  password  String

  created_at DateTime @default(now())
  updated_at DateTime @default(now())

  @@map("user")
}

model Currency {
  id                      Int                @id() @default(autoincrement())
  name                    String
  Account                 Account[]
  From_currency_exchanges CurrencyExchange[] @relation("From_currency")
  To_currency_exchanges   CurrencyExchange[] @relation("To_currency")

  created_at DateTime @default(now())
  updated_at DateTime @default(now())

  @@map("currency")
}

model Account {
  id                    Int           @id() @default(autoincrement())
  name                  String
  balance               Int
  currency_id           Int?
  Currency              Currency?     @relation(fields: [currency_id], references: [id])
  account_type          AccountStatus
  Outgoing_transactions Transaction[] @relation("From_account")
  Incoming_transactions Transaction[] @relation("To_account")

  created_at DateTime @default(now())
  updated_at DateTime @default(now())

  @@map("account")
}

model Category {
  id            Int           @id() @default(autoincrement())
  name          String
  category_type CategoryType
  Transaction   Transaction[]

  created_at DateTime @default(now())
  updated_at DateTime @default(now())

  @@map("category")
}

model Transaction {
  id               Int             @id() @default(autoincrement())
  amount           Int
  comment          String?
  from_account_id  Int
  to_account_id    Int
  category_id      Int
  categoryId       Int?
  transaction_type TransactionType
  From_account     Account?        @relation("From_account", fields: [from_account_id], references: [id])
  To_account       Account?        @relation("To_account", fields: [to_account_id], references: [id])
  Category         Category?       @relation(fields: [categoryId], references: [id])

  created_at DateTime @default(now())
  updated_at DateTime @default(now())

  @@map("transaction")
}

model CurrencyExchange {
  id               Int       @id() @default(autoincrement())
  from_currency_id Int?
  to_currency_id   Int?
  From_currency    Currency? @relation("From_currency", fields: [from_currency_id], references: [id])
  To_currency      Currency? @relation("To_currency", fields: [to_currency_id], references: [id])

  created_at DateTime @default(now())
  updated_at DateTime @default(now())

  @@map("currency_exchange")
}
